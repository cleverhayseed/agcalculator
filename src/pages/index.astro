---
import Layout from "../layouts/Layout.astro";

const tools = [
  // ========= LIVE =========
  { title: "Grain Bin Capacity (Bushels & Weight)", href: "/calculators/grain-bin-capacity/", status: "Live" },
  { title: "Grain Moisture Shrink (Wet ↔ Dry Bu)", href: "/calculators/grain-moisture-shrink/", status: "Live" },
  { title: "Hay Bale Weight & Load Planner", href: "/calculators/hay-bale-planner/", status: "Live" },
  { title: "Bale Yield Planner (Bales ↔ Tons)", href: "/calculators/bale-yield-planner/", status: "Live" },

  { title: "Fence Planner (Perimeter, Posts, Wire)", href: "/calculators/fence-planner/", status: "Live" },
  { title: "Fence Energizer Sizing (Joules & Range)", href: "/calculators/fence-energizer-sizing/", status: "Live" },

  { title: "Field Capacity & Spray Rate (ac/hr, GPA)", href: "/calculators/field-capacity/", status: "Live" },

  { title: "Livestock Water Needs (Daily & Tank Sizing)", href: "/calculators/livestock-water/", status: "Live" },

  { title: "Irrigation Runtime (Depth from Flow & Area)", href: "/calculators/irrigation-runtime/", status: "Live" },
  { title: "Rainwater Catchment (Roof → Gallons)", href: "/calculators/rainwater-catchment/", status: "Live" },

  { title: "Seed Rate & Plant Density", href: "/calculators/seed-rate-density/", status: "Live" },

  { title: "Stocking Rate & AUM", href: "/calculators/stocking-rate-aum/", status: "Live" },
  { title: "Pasture Stocking Planner (Head/Acre)", href: "/calculators/pasture-stocking/", status: "Live" },

  // ====== COMING SOON ======
  { title: "Pasture Rotation & Paddock Planner", status: "Coming soon" },
  { title: "Bale Count & Storage Planner", status: "Coming soon" },
  { title: "Fuel Use & Haul Weight (Truck/Trailer)", status: "Coming soon" },
  { title: "Pipe/Friction Loss (Flow & Pressure)", status: "Coming soon" },
  { title: "Tractor Ballast & Weight Distribution", status: "Coming soon" },
  { title: "Livestock Chute / Load-out Planner", status: "Coming soon" },
  { title: "Pond Volume & Liner Estimator", status: "Coming soon" },
  { title: "Equipment Depreciation & Ownership Cost", status: "Coming soon" },
];
---

<Layout>

<Fragment slot="head">
  <title>AgCalculator — Do the farm math.</title>
  <meta name="description" content="Fast, offline-friendly tools for farm & homestead jobs: grain bin capacity, moisture shrink, hay & bale planning, fence planning & energizer sizing, field capacity & spray GPA, livestock water, irrigation runtime, rain catchment, seed rate, stocking rate & AUM, and more." />
  <link rel="canonical" href="https://agcalculator.com/" />

  <!-- Open Graph -->
  <meta property="og:site_name" content="AgCalculator" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="AgCalculator — Do the farm math." />
  <meta property="og:description" content="Fast, offline-friendly tools for farm & homestead jobs." />
  <meta property="og:url" content="https://agcalculator.com/" />
  <meta property="og:image" content="https://agcalculator.com/og-home.png?v=1" />
  <meta property="og:image:width" content="1200" />
  <meta property="og:image:height" content="630" />

  <!-- Twitter -->
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:title" content="AgCalculator — Do the farm math." />
  <meta name="twitter:description" content="Fast, offline-friendly tools for farm & homestead jobs." />
  <meta name="twitter:image" content="https://agcalculator.com/og-home.png?v=1" />
</Fragment>

  <header>
    <div class="wrap">
      <h1>AgCalculator</h1>
      <p>Do the farm math. Fast, offline-friendly tools for common farm &amp; homestead jobs.</p>
      <p style="margin:.5rem 0 0">
        <button id="install-btn" style="display:none;padding:.4rem .7rem;border:1px solid #cbd5e1;border-radius:10px;background:white;cursor:pointer">
          Add to Home Screen
        </button>
      </p>
    </div>
  </header>

  <main class="wrap">
    <section class="grid">
      {tools.map((t) =>
        t.href ? (
          <a class="card" href={t.href}>
            <strong>{t.title}</strong>
            <div class="status live">{t.status}</div>
          </a>
        ) : (
          <div class="card">
            <strong>{t.title}</strong>
            <div class="status soon">{t.status}</div>
          </div>
        )
      )}
    </section>

    <section class="how">
      <h2>How it works</h2>
      <p>Each tool runs entirely in your browser for speed and offline use. No logins — just the math with clear formulas and step-by-step explanations so you can validate numbers quickly.</p>
      <ul>
        <li>Works on slow rural internet (and offline after first load)</li>
        <li>Clear formulas &amp; units, with practical defaults you can change</li>
        <li>Privacy-friendly analytics (Plausible) to keep improving</li>
      </ul>
      <p style="margin:.5rem 0 0"><a href="/about/">Learn more</a></p>
    </section>

    <script is:inline>
      let deferredPrompt;
      const btn = document.getElementById('install-btn');

      const isStandalone =
        window.matchMedia('(display-mode: standalone)').matches || window.navigator.standalone;

      const isIOS = /iphone|ipad|ipod/i.test(navigator.userAgent);

      window.addEventListener('beforeinstallprompt', (e) => {
        e.preventDefault();
        deferredPrompt = e;
        if (!isStandalone) btn.style.display = 'inline-block';
      });

      if (isIOS && !isStandalone) btn.style.display = 'inline-block';

      btn?.addEventListener('click', async () => {
        if (deferredPrompt) {
          deferredPrompt.prompt();
          const { outcome } = await deferredPrompt.userChoice;
          deferredPrompt = null;
          btn.textContent = outcome === 'accepted' ? 'Installed' : 'Add to Home Screen';
        } else if (isIOS) {
          alert('On iPhone/iPad: tap the Share icon → “Add to Home Screen”.');
        }
      });
    </script>
  </main>

  <footer class="wrap">
    <small>Estimates only. Verify before purchasing materials or operating equipment.</small>
  </footer>

  <style>
    :root{--green:#2F855A;--slate:#334155;--bg:#F8FAFC}
    *{box-sizing:border-box}
    body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Inter,Arial,sans-serif;background:var(--bg);color:var(--slate)}
    a{color:inherit;text-decoration:none}
    header{padding:2rem 1rem;border-bottom:1px solid #e5e7eb;background:white}
    .wrap{max-width:960px;margin:0 auto}
    h1{margin:0;font-size:clamp(1.6rem,2.6vw,2.2rem);color:var(--green)}
    p{margin:.5rem 0 0}
    .grid{display:grid;gap:1rem;padding:1.25rem 1rem}
    @media(min-width:720px){.grid{grid-template-columns:repeat(2,1fr)}}
    .card{padding:1rem;border:1px solid #e5e7eb;border-radius:14px;background:white;display:block}
    .status{display:inline-block;margin-top:.4rem;padding:.15rem .5rem;border-radius:999px;font-size:.8rem;color:white}
    .status.live{background:#22c55e}
    .status.soon{background:#94a3b8}
    .how{background:white;border:1px solid #e5e7eb;border-radius:14px;margin:0 1rem 1.5rem;padding:1rem}
    .how h2{margin:.25rem 0 .5rem;color:var(--green)}
    footer{padding:2rem 1rem;color:#64748b}
  </style>
</Layout>
