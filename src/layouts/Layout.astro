---
/* No frontmatter needed */
---
<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content={Astro.generator} />

    <!-- Favicon -->
    <link rel="icon" href="/favicon.svg" type="image/svg+xml" />

    <!-- Consent + AdSense loader -->
    <script is:inline>
      (function () {
        const KEY = 'agc_ads_consent'; // 'granted' | 'denied'
        const hasChoice = () => localStorage.getItem(KEY) === 'granted' || localStorage.getItem(KEY) === 'denied';
        const grant = () => { localStorage.setItem(KEY, 'granted'); loadAdsense(); hideBanner(); };
        const deny  = () => { localStorage.setItem(KEY, 'denied'); hideBanner(); };

        function loadAdsense() {
          if (document.getElementById('adsbygooglejs')) return;
          const s = document.createElement('script');
          s.id = 'adsbygooglejs';
          s.async = true;
          s.crossOrigin = 'anonymous';
          s.src = 'https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4050846968323757';
          document.head.appendChild(s);
        }

        function bannerEl() {
          const el = document.createElement('div');
          el.id = 'consent-banner';
          el.style.cssText = "position:fixed;inset:auto 1rem 1rem 1rem;z-index:9999;background:#fff;border:1px solid #cbd5e1;border-radius:12px;max-width:680px;margin:0 auto;padding:1rem;box-shadow:0 6px 18px rgba(0,0,0,.08)";
          el.innerHTML = `
            <div style="display:flex;gap:.8rem;align-items:flex-start">
              <div style="flex:1">
                <strong>Privacy choices</strong>
                <div style="color:#64748b;margin-top:.25rem;font-size:.95rem">
                  We use cookies for ads (Google AdSense). Choose whether to allow advertising cookies. Analytics (Plausible) is cookie-less.
                </div>
              </div>
              <div style="display:flex;gap:.5rem;flex-wrap:wrap">
                <button id="consent-allow" style="padding:.55rem .8rem;border:none;border-radius:10px;background:#2F855A;color:#fff;cursor:pointer">Allow ads</button>
                <button id="consent-deny"  style="padding:.55rem .8rem;border:1px solid #cbd5e1;border-radius:10px;background:#fff;cursor:pointer">No ads</button>
              </div>
            </div>`;
          document.body.appendChild(el);
          document.getElementById('consent-allow').onclick = grant;
          document.getElementById('consent-deny').onclick = deny;
          return el;
        }

        function hideBanner() { document.getElementById('consent-banner')?.remove(); }

        // Reopen handler (from Privacy page or footer)
        window.addEventListener('open-consent', () => {
          localStorage.removeItem(KEY);
          bannerEl();
        });

        // Add a small "Privacy choices" link to the footer automatically
        window.addEventListener('load', () => {
          const footer = document.querySelector('footer .wrap small');
          if (footer && !footer.querySelector('#privacy-choices-inline')) {
            const sep = document.createTextNode(' · ');
            const link = document.createElement('a');
            link.id = 'privacy-choices-inline';
            link.href = '#';
            link.textContent = 'Privacy choices';
            link.style.cssText = 'color:#2F855A;text-decoration:none;';
            link.onclick = (e) => { e.preventDefault(); window.dispatchEvent(new CustomEvent('open-consent')); };
            footer.appendChild(sep);
            footer.appendChild(link);
          }
        });

        // First-load behavior
        if (hasChoice()) {
          if (localStorage.getItem(KEY) === 'granted') loadAdsense();
        } else {
          // Show banner until a choice is made
          if (document.readyState === 'complete') bannerEl(); else window.addEventListener('load', bannerEl);
        }
      })();
    </script>


    <!-- Plausible queue (in case the external script is slow to load) -->
    <script is:inline>
      window.plausible = window.plausible || function () {
        (window.plausible.q = window.plausible.q || []).push(arguments);
      };
    </script>
    <!-- Plausible main script (site-wide) -->
    <script defer data-domain="agcalculator.com" src="https://plausible.io/js/script.js"></script>

    <!-- PWA / icons -->
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
    <link rel="icon" type="image/png" sizes="192x192" href="/icons/icon-192.png" />
    <link rel="icon" type="image/png" sizes="512x512" href="/icons/icon-512.png" />

    <!-- PWA manifest + theme color -->
    <link rel="manifest" href="/manifest.webmanifest" />
    <meta name="theme-color" content="#2F855A" />

    <!-- iOS Add to Home Screen helpers -->
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-title" content="AgCalculator" />
    <meta name="apple-mobile-web-app-status-bar-style" content="default" />

    <script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "Organization",
  "name": "AgCalculator",
  "url": "https://agcalculator.com",
  "logo": "https://agcalculator.com/icons/icon-192.png",
  "sameAs": [
    "mailto:info@cleverhayseed.com"
  ]
}
</script>
<!-- Site entity & navigation (E-E-A-T) -->
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "WebSite",
  "name": "AgCalculator",
  "url": "https://agcalculator.com"
}
</script>

<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "SiteNavigationElement",
  "name": ["Calculators", "About", "Privacy", "Terms"],
  "url": [
    "https://agcalculator.com/",
    "https://agcalculator.com/about/",
    "https://agcalculator.com/privacy/",
    "https://agcalculator.com/terms/"
  ]
}
</script>


    <style>
  :root{ --green:#2F855A; --slate:#334155; --bg:#F8FAFC }
  *{ box-sizing:border-box }
  body{ margin:0; font-family:system-ui,-apple-system,Segoe UI,Inter,Arial,sans-serif; background:var(--bg); color:var(--slate) }
  a{ color:var(--green); text-decoration:none }
</style>


    <!-- Pages can inject title/canonicals/JSON-LD here -->
    <slot name="head" />
  </head>

  <body>
    <slot />

    <!-- Site-wide footer -->
   <footer style="padding:2rem 1rem;color:#64748b">
  <div class="wrap" style="max-width:960px;margin:0 auto;">
<small>
  © {new Date().getFullYear()} AgCalculator ·
  <a href="/about/" style="color:#2F855A;text-decoration:none;">About</a>
  ·
  <a href="/privacy/" style="color:#2F855A;text-decoration:none;">Privacy</a>
  ·
  <a href="/terms/" style="color:#2F855A;text-decoration:none;">Terms</a>
  ·
  <a href="mailto:info@cleverhayseed.com" style="color:#2F855A;text-decoration:none;">Contact</a>
</small>


  </div>
</footer>

    <!-- Install-app logic (footer link) -->
    <script is:inline>
      (function () {
        const installLink = document.getElementById('install-app');
        if (!installLink) return;

        let deferredPrompt = null;

        // Detect iOS (no beforeinstallprompt)
        const isIOS = () => /iphone|ipad|ipod/i.test(navigator.userAgent);

        window.addEventListener('beforeinstallprompt', (e) => {
          // Prevent the mini-infobar on mobile
          e.preventDefault();
          deferredPrompt = e;
        });

        installLink.addEventListener('click', async (evt) => {
          evt.preventDefault();

          if (deferredPrompt) {
            deferredPrompt.prompt();
            const { outcome } = await deferredPrompt.userChoice;
            try { window.plausible && window.plausible('A2HS installed'); } catch {}
            deferredPrompt = null;
            return;
          }

          // Fallback guidance (works on iOS and any browser without a prompt)
          if (isIOS()) {
            alert('On iPhone/iPad: tap the Share button → “Add to Home Screen”.');
          } else {
            alert('Use your browser menu → “Install app” or “Add to Home screen”.');
          }
        });
      })();
    </script>

    <!-- Register service worker -->
    <script is:inline>
      if ('serviceWorker' in navigator) {
        window.addEventListener('load', () => {
          navigator.serviceWorker.register('/sw.js').catch(console.error);
        });
      }
    </script>
  </body>
</html>
